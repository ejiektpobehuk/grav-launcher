## ГРАВ launcher

Консольная программа для обновления и запуска игры [ГРАВ](https://arigven.games/grav/).

Игру разрабатывает [@ARIGVEN](https://github.com/arigven), не я.

Игра ещё на ранних этапах разработки и не распространяется через какие-либо игровые площадки.
Поэтому обновления приходится загружать вручную, что на SteamDeck'e делать неудобно.

`grav-launcher` автоматизирует процесс проверки и загрузки новой версии.

### Установка на Steam Deck

1. Переключиться в Desktop Mode
1. Загрузить файл `grav-launcher` из [релизов](https://github.com/ejiektpobehuk/grav-launcher/releases)
1. Сделать его исполняемым
    1. В проводнике открыть его контекстное меню - `L2` при курсоре на файле
    1. Выбрать в контекстном меню Свойства / `Properties`
    1. В окне свойств переключиться на вкладку `Permissions`
    1. Поставить галочку `Is executable`
    1. Принять изменения - `Ok`
1. Добавить в Steam - в контекстном меню файла `Add to Steam`

На этом этапе launcher уже работает, но ничего не отображает.
Для отображения интерфейса нужно запускать приложение через эмулятор терминала:

1. Найти grav-launcher в библиотеки Steam
1. Открыть его контекстное меню
1. Выбрать в контекстном меню Свойства / `Properties`
1. В окне свойств указать
    - **TARGET** `"konsole"`
    - **LAUNCH OPTIONS** `-e /home/deck/Downloads/grav-launcher`

### Управление с контроллера

Для удобства использования на Steam Deck реализована поддержка контроллера:

- Кнопка B (East) - выход из приложения
- D-pad вправо/вниз - переключение на следующий лог
- D-pad влево/вверх - переключение на предыдущий лог

### Roadmap

- [x] сборка бинаря в релизах
- [ ] pin версии Rust и автоматизация для обновления
- [x] поддержка контроллера для навигации по логам и выхода
- [ ] навигация по логам
- [ ] обновление самого launcher'а из launcher'a
- [ ] graceful shutdown

### NixOS build fixes

Patch NixOS Rust binary to work on SteamOS

```sh
nix shell nixpkgs#patchelf --command patchelf --set-interpreter /usr/lib64/ld-linux-x86-64.so.2 target/release/grav-launcher
```
